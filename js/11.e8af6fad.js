(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{e82f:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[e.loadingSomething?a("q-linear-progress",{attrs:{indeterminate:"",color:"negative"}}):e._e(),a("breadcrumbs",{attrs:{links:e.links}}),a("auditLogs",{attrs:{main:e.main}})],1)},i=[],n=(a("07de"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("q-tabs",{staticClass:"text-black bg-secondary",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"logins",label:"Logins"}})],1),a("q-tab-panels",{staticClass:"q-ma-none full-width q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{staticClass:"q-pa-none q-ma-none",attrs:{name:"logins"}},[a("logins",{attrs:{main:e.main,immediateMain:e.immediateMain}})],1),a("q-tab-panel",{staticClass:"q-pa-none q-ma-none",attrs:{name:"activeDevices"}},[a("logins",{attrs:{main:e.main,immediateMain:e.immediateMain}})],1)],1)],1)}),r=[],o=(a("5319"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("q-table",{staticClass:"col",attrs:{title:"Logins",dense:"",data:e.allLogins,columns:e.columns,filter:e.filter,"row-key":"loginId",selection:"multiple",selected:e.selected},on:{"row-click":e.selectLogin,"update:selected":function(t){e.selected=t}},scopedSlots:e._u([{key:"top-left",fn:function(){return[a("dateTimeRange",{attrs:{immediateMain:e.myImmediateMain,id:e.id}})]},proxy:!0},{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",outlined:"",dense:"",debounce:"300",placeholder:"Search"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),a("q-btn",{attrs:{flat:"",disable:!e.selectedRows}},[a("q-icon",{attrs:{color:"primary",name:"logout",side:""},on:{click:function(t){return e.logoutSelected()}}})],1),a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"refresh",side:""},on:{click:function(t){return e.fetchLogins()}}})],1)]},proxy:!0},{key:"body-cell-ip",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[t.row.isMe?a("q-icon",{staticClass:"text-white",attrs:{name:"person"}}):e._e(),a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-browser",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-os",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-platform",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-createdAt",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-email",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-active",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[t.row[t.col.name]?e._e():a("q-chip",{staticClass:"text-weight-bolder",attrs:{color:!0===t.row.active?"green":"red","text-color":"white",dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))]),t.row[t.col.name]?a("q-btn",{staticClass:"bg-white",attrs:{flat:"",icon:"logout"},on:{click:function(a){return e.logoutFromBtn(t.row)}}}):e._e()],1)]}}])})],1)}),l=[],c=(a("ddb0"),a("6558"));const d=a("1712").to,m=a("20e6"),g=a("c2a1").default;var b={name:"logins",props:["main","immediateMain"],components:{dateTimeRange:c["a"]},async created(){g.setSettings({TBURL:m["TB_URL"]}),g.setVue(this),this.fetchLogins()},data(){return{id:1,myImmediateMain:this,dateTimeRanges:{},dateRangeSelectType:"last",dateRangeSelectLabel:"",selected:[],columns:[{name:"email",label:"Email",field:"email",sortable:!0},{name:"ip",label:"IP",field:"ip",sortable:!0},{name:"browser",label:"Browser",field:"browser",sortable:!0},{name:"os",label:"OS",field:"os",sortable:!0},{name:"platform",label:"Platform",field:"platform",sortable:!0},{name:"active",label:"Active",field:"active",sortable:!0},{name:"createdAt",label:"Created",field:"createdAt",sortable:!0}],allLogins:[],selectedRow:{},filter:""}},methods:{async logoutFromBtn(e){await this.logoutSelected([e])},async logoutSelected(e){return new Promise((async(t,a)=>{let s=!1,i=(e||this.selected).map((e=>e));i.map((e=>{e.isMe&&(s=!0)})),i=i.filter((e=>!e.isMe&&""!==e.token)),i=i.map((e=>e.token)),s&&this.$q.notify({type:"negative",message:"We will not log you out from here"});let n=i.map(g.logout);this.main.loadingSomething=!0;let[r,o]=await d(Promise.all(n));if(this.main.loadingSomething=!1,r)return this.$q.notify({type:"negative",message:r.msg||r}),t(!1);await d(this.fetchLogins()),t()}))},async runSelected(){return this.fetchLogins()},async fetchLogins(){let e={};this.main.selectedRow&&(e={userId:this.main.selectedRow.userId}),this.dateTimeRanges[this.id]||(this.dateTimeRanges[this.id]={}),this.dateTimeRanges[this.id].interval&&(e.createdAt={},this.dateTimeRanges[this.id].interval.to&&("now"===this.dateTimeRanges[this.id].interval.to?e.createdAt["lte"]=new Date:e.createdAt["lte"]=this.dateTimeRanges[this.id].interval.to),this.dateTimeRanges[this.id].interval.from&&(this.dateTimeRanges[this.id].interval.from<0?e.createdAt["gte"]=new Date((new Date).getTime()+1e3*this.dateTimeRanges[this.id].interval.from):e.createdAt["gte"]=this.dateTimeRanges[this.id].interval.from)),"activeDevices"===this.immediateMain.tab&&(e["tokenExpiry"]={gte:parseInt((new Date).getTime()/1e3)},e["token"]={ne:""}),this.main.loadingSomething=!0;let[t,a]=await d(g.getLogins(e));this.main.loadingSomething=!1;let s=g.currentToken();t||(a=a.map((e=>(e.active=""!==e.token,e.token===s?e.isMe=!0:e.isMe=!1,e))),this.allLogins=a)},selectLogin(e,t){t.active&&(this.selectedRow=t)}},computed:{selectedRows(){let e=this.selected.filter((e=>e.active));return e.length>0}},watch:{selectedRow:{handler(e){JSON.stringify(this.selectedRow)!==JSON.stringify(this.main.selectedRow)?this.main.editted=!0:this.main.editted=!1},deep:!0}}},p=b,u=a("2877"),h=a("9989"),w=a("eaac"),f=a("9c40"),y=a("4e73"),v=a("f09f"),q=a("a370"),k=a("3786"),_=a("4b7e"),R=a("27f9"),M=a("0016"),T=a("db86"),x=a("b047"),L=a("eebe"),S=a.n(L),Q=Object(u["a"])(p,o,l,!1,null,null,null),C=Q.exports;S()(Q,"components",{QPage:h["a"],QTable:w["a"],QBtn:f["a"],QMenu:y["a"],QCard:v["a"],QCardSection:q["a"],QRadio:k["a"],QCardActions:_["a"],QInput:R["a"],QIcon:M["a"],QTd:T["a"],QChip:x["a"]});a("20e6"),a("c2a1").default;var A={name:"userDetails",props:["main"],components:{logins:C},async created(){let e,t,a=window.location.hash.replace(/^[#]*[\/]*/,""),s=a.match(/(audit_logs)\/([0-9a-z-]+)[\/]*([a-zA-Z]+)/);s&&"audit_logs"===s[1]&&(e=s[2],t=s[3]),e&&(this.selectedRow={userId:e}),t&&(this.tab=t)},data(){return{tab:"logins",immediateMain:this}},methods:{},computed:{},watch:{}},P=A,I=a("429bb"),B=a("7460"),D=a("adad"),O=a("823b"),E=Object(u["a"])(P,n,r,!1,null,null,null),$=E.exports;S()(E,"components",{QPage:h["a"],QTabs:I["a"],QTab:B["a"],QTabPanels:D["a"],QTabPanel:O["a"]});var J=a("2cbd");const U=a("c2a1").default,j=(a("1712").to,a("20e6"));var z={name:"auditLogsP",components:{auditLogs:$,breadcrumbs:J["a"]},data(){return{main:this,loadingSomething:!1,links:[{label:"System",icon:"settings",to:"/system"},{label:"Audit Logs",icon:"track_changes",to:"/system/audit_logs"}]}},async created(){U.setSettings({TBURL:j["TB_URL"]}),U.setVue(this)},methods:{}},F=z,N=a("6b1d"),V=Object(u["a"])(F,s,i,!1,null,"63780710",null);t["default"]=V.exports;S()(V,"components",{QPage:h["a"],QLinearProgress:N["a"]})}}]);